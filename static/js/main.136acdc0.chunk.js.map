{"version":3,"sources":["component/ServiceContext/ServiceContext.js","component/ErrorBoundary/ErrorBoundary.js","constants/initialSorter.js","constants/filterTypes.js","reducers/reducer.js","store.js","component/Header/Header.js","utils/sortFunction.js","utils/createFilterFunction.js","utils/CookieMethods.js","actions/actions.js","component/hoc/connectWithBookService.js","component/Filter/Filter.js","component/Sorter/Sorter.js","utils/createSorterElement.js","component/FilterSorterBlock/FilterSorterBlock.js","component/Spinner/Spinner.js","component/ErrorElement/ErrorElement.js","component/BookCard/BookCard.js","component/ItemList/ItemList.js","component/BookList/BookList.js","component/FavoritesList/FavoritesList.js","component/PageNotFound/PageNotFound.js","component/FavoritesButton/FavoritesButton.js","component/MainPageButton/MainPageButton.js","component/App/App.js","api/EmulatedBackend.js","api/BookService.js","index.js"],"names":["React","createContext","ServiceProvider","Provider","ServiceConsumer","Consumer","ErrorBoundary","state","hasError","this","className","error","props","children","Component","initialSorter","active","sortersObject","title","type","name","ascendingDirection","raiting","date","filterTypes","text","value","publisher","options","author","initialState","list","favorites","filterState","sorterState","loading","reducer","action","console","log","payload","store","createStore","Header","sortFunction","sorter","newList","sort","a","b","localeCompare","reverse","createFilterFunction","createdFilter","Object","keys","filter","filterName","forEach","book","CookieMethods","cookieName","regexp","RegExp","cookieRawValue","document","cookie","match","valueArray","join","id","cookieArray","getCookieValue","push","_setCookie","newCookieArray","some","contains","remove","add","cookieMethods","fetchBookListSuccess","data","fetchBookListFailure","fetchBooks","dispatch","ownProps","bookService","getAllBooks","then","catch","err","fetchFilteredBooks","newFilterState","getFilteredBooks","addSortedBooks","currentSorter","newSorterState","fetchFavorites","fetchFavoritesListSuccess","connectWithBookService","Wrapped","Filter","onChangeHandler","filterObject","event","setState","temporaryFilterState","target","onSubmitHandler","preventDefault","onClearHandler","resetFilter","prevProps","filterNames","onSubmit","map","number","key","htmlFor","onChange","optionText","index","placeholder","onClick","connectWithStore","Sorter","onClickHandler","sorters","activeSorter","sorterName","findSorterFontWeight","findSorterDirection","stateProps","dispatchProps","updatedOwnProps","FilterSorterBlock","Spinner","role","ErrorElement","Card","onRaitingChangeHandler","newValue","raitingValue","raitingElement","current","textContent","disabled","favoriteClickHandler","toggle","favorite","createRef","style","width","ref","ItemList","fetchItems","Content","listName","length","connectWithcRouter","history","goBack","FavoritesButton","to","MainPageButton","App","path","exact","component","BookList","FavoritesList","PageNotFound","timeout","Promise","resolve","reject","Math","round","random","Error","setTimeout","emulatedBackend","adress","returnAllBooks","returnFilteredBooks","body","books","filters","allFilteredBooks","currentlyFilteredBooks","filterRawValue","filterType","filterValue","trim","toLowerCase","includes","format","find","emulatedFetch","ReactDOM","render","basename","getElementById"],"mappings":"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","file":"static/js/main.136acdc0.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nconst { \r\n    Provider: ServiceProvider,\r\n    Consumer: ServiceConsumer,\r\n} = React.createContext();\r\n\r\nexport {\r\n    ServiceProvider,\r\n    ServiceConsumer,\r\n};","import React from 'react';\r\n\r\nexport default class ErrorBoundary extends React.Component {\r\n    state = { hasError: false };\r\n\r\n    static getDerivedStateFromError(error) {\r\n        return { hasError: error };\r\n    }\r\n\r\n    render() {\r\n        return this.state.hasError ? \r\n        <div className=\"text-center my-4 w-100\">\r\n            {`Ошибка: ${this.state.error}`}\r\n        </div> :\r\n        this.props.children;\r\n    }\r\n}\r\n","const initialSorter = {\r\n    active: 'title',\r\n    sortersObject: {\r\n        title: {\r\n            type: 'title',\r\n            name: 'По алфавиту',\r\n            ascendingDirection: true,\r\n        },\r\n        raiting: {\r\n            type: 'raiting',\r\n            name: 'По рейтингу',\r\n            ascendingDirection: true,\r\n        },\r\n        date: {\r\n            type: 'date',\r\n            name: 'По дате',\r\n            ascendingDirection: true,\r\n        }\r\n    }, \r\n};\r\n\r\nexport default initialSorter;","const filterTypes = {\r\n    title: { name: \"title\", text: \"Название\", value: \"\", type: \"includes\" },\r\n    publisher: { name: \"publisher\", text: \"Издатель\", value: \"\", type: \"select\", options: [], },\r\n    author: { name: \"author\", text: \"Автор\", value: \"\", type: \"select\", options: [], },\r\n    date: { name: \"date\", text: \"Год\", value: \"\", type: \"select\", options: [], },\r\n};\r\n\r\nexport default filterTypes;","import initialSorter from '../constants/initialSorter';\r\nimport filterTypes from '../constants/filterTypes';\r\n\r\nconst initialState = {\r\n    list: [],\r\n    favorites: [],\r\n    filterState: { ...filterTypes },\r\n    sorterState: { ...initialSorter },\r\n    loading: true,\r\n    error: null,\r\n};\r\n\r\nconst reducer = (state = initialState, action) => {\r\n    console.log(action.type);\r\n\r\n    switch(action.type) {\r\n        case 'FETCH_BOOK_LIST_REQUEST':\r\n            return {\r\n                ...state,\r\n                list: [],\r\n                loading: true,\r\n                error: null,\r\n            };\r\n        case 'FETCH_BOOK_LIST_SUCCESS':\r\n            return {\r\n                ...state,\r\n                list: action.payload.list,\r\n                filterState: action.payload.filterState,\r\n                sorterState: action.payload.sorterState,\r\n                loading: false,\r\n                error: null,\r\n            };\r\n        case 'FETCH_BOOK_LIST_FAILURE':\r\n            return {\r\n                ...state,\r\n                list: [],\r\n                loading: false,\r\n                error: action.payload,\r\n            };\r\n            case 'FETCH_FAVORITES_LIST_REQUEST':\r\n            return {\r\n                ...state,\r\n                favorites: [],\r\n                loading: true,\r\n                error: null,\r\n            };\r\n        case 'FETCH_FAVORITES_LIST_SUCCESS':\r\n            return {\r\n                ...state,\r\n                favorites: action.payload.favorites,\r\n                sorterState: action.payload.sorterState,\r\n                loading: false,\r\n                error: null,\r\n            };\r\n        case 'FETCH_FAVORITES_LIST_FAILURE':\r\n            return {\r\n                ...state,\r\n                favorites: [],\r\n                loading: false,\r\n                error: action.payload,\r\n            };\r\n        default: return state;\r\n    }\r\n};\r\n\r\nexport default reducer;","import { createStore } from 'redux';\r\nimport reducer from './reducers/reducer';\r\n\r\nconst store = createStore(reducer);\r\n\r\nexport default store;","import React from 'react';\r\n\r\nconst Header = () => {\r\n    return (\r\n        <div className=\"d-flex flex-row flex-wrap justify-content-around mb-4\">\r\n            <h1>Книжный магазин</h1>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Header;","const sortFunction = (list, sorter) => {\r\n    let newList;\r\n    switch (sorter.active) {\r\n        case 'date':\r\n            if (sorter.sortersObject[sorter.active].ascendingDirection === true) {\r\n                newList = list.sort((a,b) => a.date - b.date);\r\n            } else {\r\n                newList = list.sort((a,b) => b.date - a.date);\r\n            }\r\n            break;\r\n        case 'raiting':\r\n            if (sorter.sortersObject[sorter.active].ascendingDirection === true) {\r\n                newList = list.sort((a,b) => a.raiting - b.raiting);\r\n            } else {\r\n                newList = list.sort((a,b) => b.raiting - a.raiting);\r\n            }\r\n            break;\r\n        default:\r\n            if (sorter.sortersObject[sorter.active].ascendingDirection === true) {\r\n                newList = list.sort((a,b) => a.title.localeCompare(b.title));\r\n            } else {\r\n                newList = list.sort((a,b) => a.title.localeCompare(b.title)).reverse();\r\n            }\r\n    }\r\n    return newList;\r\n}\r\n\r\nexport default sortFunction;","import filterTypes from '../constants/filterTypes';\r\n\r\n// Создаём выпадающий список доступных авторов, издательств и пр.\r\nexport default function createFilterFunction(list) {\r\n    const createdFilter = {};\r\n    // Смотрим, какие фильтры должны быть в виде выпадающего списка\r\n    const selectTypeFilters = Object.keys(filterTypes).filter(filterName => filterTypes[filterName].type === \"select\");\r\n    selectTypeFilters.forEach(filterName => {\r\n        // копируем настройки фильтра по умолчанию\r\n        createdFilter[filterName] = { ...filterTypes[filterName] };\r\n        // Проходим по массиву книг и собираем все поля для запрошенного фильтра,\r\n        // помещаем их в массив options\r\n        const options = {};\r\n        list.forEach(book => options[book[filterName]] = true);\r\n        createdFilter[filterName].options = Object.keys(options);\r\n    });\r\n    const respond = {\r\n        ...filterTypes,\r\n        ...createdFilter,\r\n    };\r\n    return respond;\r\n}","export default class CookieMethods {\r\n    constructor(cookieName) {\r\n        this.cookieName = cookieName;\r\n    }\r\n\r\n    getCookieValue() {\r\n        const regexp = new RegExp(`(${this.cookieName}=)([\\\\d,]*)(;|$)`);\r\n        const cookieRawValue = document.cookie.match(regexp);\r\n        console.log(cookieRawValue)\r\n        return  [];\r\n    }\r\n\r\n    _setCookie(valueArray) {\r\n        document.cookie = `${this.cookieName}=${valueArray.join(',')}; path=/;`\r\n    }\r\n\r\n    add(id) {\r\n        const cookieArray = this.getCookieValue();\r\n        cookieArray.push(id);\r\n        this._setCookie(cookieArray);\r\n    }\r\n\r\n    remove(id) {\r\n        const cookieArray = this.getCookieValue();\r\n        const newCookieArray = cookieArray.filter(value => +value !== id);\r\n        this._setCookie(newCookieArray);\r\n    }\r\n\r\n    contains(id) {\r\n        const cookieArray = this.getCookieValue();\r\n        return cookieArray.some(value => +value === id);\r\n    }\r\n\r\n    toggle(id) {\r\n        if(this.contains(id)) {\r\n            this.remove(id);\r\n        } else {\r\n            this.add(id);\r\n        }\r\n    }\r\n}","import initialSorter from '../constants/initialSorter';\r\nimport sortFunction from '../utils/sortFunction';\r\nimport createFilterFunction from '../utils/createFilterFunction';\r\nimport CookieMethods from '../utils/CookieMethods';\r\n\r\nconst cookieMethods = new CookieMethods(\"favoriteBooks\");\r\n\r\nconst fetchBookListRequest = () => {\r\n    return {\r\n        type: \"FETCH_BOOK_LIST_REQUEST\",\r\n    }\r\n};\r\nconst fetchBookListSuccess = (data) => {\r\n    return {\r\n        type: \"FETCH_BOOK_LIST_SUCCESS\",\r\n        payload: data,\r\n    }\r\n};\r\nconst fetchBookListFailure = (error) => {\r\n    return {\r\n        type: \"FETCH_BOOK_LIST_FAILURE\",\r\n        payload: error,\r\n    }\r\n};\r\n\r\nconst fetchBooks = (dispatch, ownProps) => () => {\r\n    const { bookService } = ownProps;\r\n    dispatch(fetchBookListRequest());\r\n    bookService.getAllBooks()\r\n            .then(data => dispatch(fetchBookListSuccess({\r\n                list: sortFunction(data.list, initialSorter),\r\n                filterState: createFilterFunction(data.list),\r\n                sorterState: initialSorter,\r\n            })))\r\n            .catch(err => dispatch(fetchBookListFailure(err)))\r\n}\r\n\r\nconst fetchFilteredBooks = (dispatch, ownProps) => (newFilterState) => {\r\n    const { bookService } = ownProps;\r\n    dispatch(fetchBookListRequest());\r\n    bookService.getFilteredBooks(newFilterState)\r\n            .then(data => dispatch(fetchBookListSuccess({\r\n                list: sortFunction(data.list, initialSorter),\r\n                filterState: newFilterState,\r\n                sorterState: initialSorter,\r\n            })))\r\n            .catch(err => dispatch(fetchBookListFailure(err)))\r\n}\r\n\r\nconst addSortedBooks = (dispatch, ownProps) => (currentSorter) => {\r\n    const { list, filterState, sorterState } = ownProps.state;\r\n    let newSorterState = {\r\n        active: currentSorter.type,\r\n        sortersObject: { ...initialSorter.sortersObject },\r\n    };\r\n    newSorterState.sortersObject[currentSorter.type] = {\r\n        ...currentSorter,\r\n        ascendingDirection: sorterState.active !== currentSorter.type ? true : !currentSorter.ascendingDirection,\r\n    }\r\n    const newList = sortFunction(list, newSorterState);\r\n    dispatch(fetchBookListSuccess({\r\n        list: newList,\r\n        filterState,\r\n        sorterState: newSorterState\r\n    }));\r\n}\r\n\r\nconst fetchFavoritesListRequest = () => {\r\n    return {\r\n        type: \"FETCH_FAVORITES_LIST_REQUEST\",\r\n    }\r\n};\r\nconst fetchFavoritesListSuccess = (data) => {\r\n    return {\r\n        type: \"FETCH_FAVORITES_LIST_SUCCESS\",\r\n        payload: data,\r\n    }\r\n};\r\nconst fetchFavoritesListFailure = (error) => {\r\n    return {\r\n        type: \"FETCH_FAVORITES_LIST_FAILURE\",\r\n        payload: error,\r\n    }\r\n};\r\n\r\nconst fetchFavorites = (dispatch, ownProps) => () => {\r\n    const { bookService } = ownProps;\r\n    const cookieArray = cookieMethods.getCookieValue();\r\n    const filter = {\r\n        id: { name: \"id\", text: \"\", value: \"array-exact\", type: \"array-exact\", options: cookieArray, },\r\n    };\r\n    dispatch(fetchFavoritesListRequest());\r\n    bookService.getFilteredBooks(filter)\r\n            .then(data => dispatch(fetchFavoritesListSuccess({\r\n                favorites: sortFunction(data.list, initialSorter),\r\n                sorterState: initialSorter,\r\n            })))\r\n            .catch(err => dispatch(fetchFavoritesListFailure(err)))\r\n}\r\n\r\nexport {\r\n    fetchBooks,\r\n    fetchFilteredBooks,\r\n    addSortedBooks,\r\n    fetchFavorites,\r\n};","import React from 'react';\r\nimport { ServiceConsumer } from '../ServiceContext/ServiceContext';\r\n\r\nexport default function connectWithBookService(Wrapped) {\r\n    return (props) => {\r\n        return (\r\n            <ServiceConsumer>\r\n                {\r\n                    (value) => {\r\n                        return <Wrapped {...props} bookService={value} />\r\n                    }\r\n                }\r\n            </ServiceConsumer>\r\n        );\r\n    }\r\n};","import React from 'react';\r\nimport { connect as connectWithStore } from 'react-redux';\r\n\r\nimport { fetchFilteredBooks } from '../../actions/actions';\r\nimport connectWithBookService from '../hoc/connectWithBookService';\r\nimport filterTypes from '../../constants/filterTypes';\r\n\r\nclass Filter extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            temporaryFilterState: {\r\n                ...filterTypes,\r\n                ...props.filterState,\r\n            },\r\n        };\r\n    }\r\n\r\n    componentDidUpdate(prevProps) {\r\n        if (this.props.filterState !== prevProps.filterState) {\r\n            this.setState({ temporaryFilterState: this.props.filterState });\r\n        }\r\n    }\r\n\r\n    onChangeHandler = (filterObject) => (event) => {\r\n        this.setState({\r\n            temporaryFilterState: {\r\n                ...this.state.temporaryFilterState,\r\n                [filterObject.name]: { ...filterObject, value: event.target.value },\r\n            }\r\n        });\r\n    };\r\n\r\n    onSubmitHandler = (event) => {\r\n        event.preventDefault();\r\n        this.props.fetchFilteredBooks(this.state.temporaryFilterState);\r\n    }\r\n\r\n    onClearHandler = (event) => {\r\n        event.preventDefault();\r\n        let resetFilter = {};\r\n        const { temporaryFilterState } = this.state;\r\n        const filterNames = Object.keys(temporaryFilterState);\r\n        filterNames.forEach(filterName => resetFilter[filterName] = {\r\n            ...temporaryFilterState[filterName],\r\n            value: \"\",\r\n        });\r\n        this.props.fetchFilteredBooks(resetFilter);\r\n    }\r\n\r\n    render() {\r\n        const { temporaryFilterState } = this.state;\r\n        const filterNames = Object.keys(temporaryFilterState);\r\n        return (\r\n            <div className=\"d-flex flex-row flex-wrap justify-content-around mb-4\">\r\n                <h5>Фильтр</h5>\r\n                <form onSubmit={this.onSubmitHandler} className=\"w-100\">\r\n                        {filterNames.map((filterName, number) => {\r\n                            const filterObject = temporaryFilterState[filterName];\r\n                            switch(filterObject.type) {\r\n                                case \"select\":\r\n                                    return <div key={`input${number}`} className=\"form-group\">\r\n                                            <label htmlFor={`formControlInput${number}`}>{filterObject.text}</label>\r\n                                            <select\r\n                                                id={`formControlInput${number}`}\r\n                                                className=\"form-control\"\r\n                                                value={temporaryFilterState[filterName] ? temporaryFilterState[filterName].value : \"\"}\r\n                                                onChange={this.onChangeHandler(temporaryFilterState[filterName])}\r\n                                            >\r\n                                                <option value=\"\"></option>\r\n                                                {filterObject.options.map((optionText, index) =>\r\n                                                    <option\r\n                                                        key={`${filterName}option${index}`}\r\n                                                        value={optionText}\r\n                                                    >{optionText}</option>\r\n                                                )}\r\n                                            </select>\r\n                                        </div>\r\n                                default:\r\n                                    return <div key={`input${number}`} className=\"form-group\">\r\n                                        <label htmlFor={`formControlInput${number}`}>{filterObject.text}</label>\r\n                                        <input\r\n                                            onChange={this.onChangeHandler(temporaryFilterState[filterName])}\r\n                                            type=\"text\"\r\n                                            className=\"form-control\"\r\n                                            id={`formControlInput${number}`}\r\n                                            placeholder=\"Введите текст\"\r\n                                            value={temporaryFilterState[filterName] ? temporaryFilterState[filterName].value : \"\"}\r\n                                        />\r\n                                    </div>\r\n                            }\r\n                        })}\r\n                    <button className=\"btn btn-outline-primary\" type=\"submit\">Отфильтровать</button>\r\n                    <button className=\"btn btn-outline-secondary mx-2\" type=\"reset\" onClick={this.onClearHandler}>Очистить</button>\r\n                </form>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return { filterState: state.filterState }\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch, ownProps) => {\r\n    return {\r\n        fetchFilteredBooks: fetchFilteredBooks(dispatch, ownProps),\r\n    }\r\n}\r\n\r\nexport default \r\n    connectWithBookService(\r\n        connectWithStore(mapStateToProps, mapDispatchToProps)(Filter)\r\n    );","import React from 'react';\r\nimport { connect as connectWithStore } from 'react-redux';\r\n\r\nimport { addSortedBooks } from '../../actions/actions';\r\nimport connectWithBookService from '../hoc/connectWithBookService';\r\nimport { findSorterDirection, findSorterFontWeight } from '../../utils/createSorterElement';\r\n\r\nclass Sorter extends React.Component {\r\n    onClickHandler = (currentSorter) => () => {\r\n        this.props.addSortedBooks(currentSorter);\r\n    }\r\n\r\n    render() {\r\n        const { sorterState: { sortersObject: sorters, active: activeSorter } } = this.props.state;\r\n        return (\r\n            <div className=\"my-3\">\r\n                <span>Сортировка </span>\r\n                {Object.keys(sorters).map(sorterName => {\r\n                    const sorter = sorters[sorterName];\r\n                    return <button\r\n                        key={`Sorter_${sorter.type}`}\r\n                        onClick={this.onClickHandler(sorter)}\r\n                        type=\"button\"\r\n                        className=\"btn btn-outline-primary btn-sm mx-1 my-1\"\r\n                    >\r\n                        { findSorterFontWeight(sorter, activeSorter) }: { findSorterDirection(sorter) }\r\n                    </button>\r\n                })}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return { state }\r\n};\r\n\r\nconst mergeProps = (stateProps, dispatchProps, ownProps) => {\r\n    const { dispatch } = dispatchProps;\r\n    const updatedOwnProps = {\r\n        ...ownProps,\r\n        ...stateProps,\r\n    }\r\n    return {\r\n      ...stateProps,\r\n      addSortedBooks: addSortedBooks(dispatch, updatedOwnProps),\r\n    }\r\n  }\r\n\r\nexport default \r\n    connectWithBookService(\r\n        connectWithStore(mapStateToProps, null, mergeProps)(Sorter)\r\n    );","import React from 'react';\r\n\r\nconst findSorterDirection = (sorter) => sorter.ascendingDirection === true ? <span>по возрастанию</span> : <span>по убыванию</span>;\r\nconst findSorterFontWeight = (sorter, activeSorter) => sorter.type === activeSorter ? <b>{sorter.name}</b> : <span>{sorter.name}</span>;\r\n\r\nexport { findSorterDirection, findSorterFontWeight };","import React from 'react';\r\nimport Filter from '../Filter/Filter';\r\nimport Sorter from '../Sorter/Sorter';\r\n\r\nconst FilterSorterBlock = () => <>\r\n    <hr/>\r\n    <Filter/>\r\n    <Sorter/>\r\n    <hr/>\r\n</>\r\n\r\nexport default FilterSorterBlock;","import React from 'react';\r\n\r\nconst Spinner = () => {\r\n    return (\r\n        <div className=\"spinner-border\" role=\"status\">\r\n            <span className=\"sr-only\">Loading...</span>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Spinner;","import React from 'react';\r\n\r\nconst ErrorElement = (props) => {\r\n    return (\r\n        <div className=\"text-center my-4 w-100\">\r\n            {`Ошибка: ${props.error}`}\r\n        </div>\r\n    );\r\n}\r\nexport default ErrorElement;","import React from 'react';\r\nimport CookieMethods from '../../utils/CookieMethods';\r\n\r\nconst cookieMethods = new CookieMethods(\"favoriteBooks\");\r\n\r\nexport default class Card extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.raitingElement = React.createRef();\r\n        this.id = props.book.id;\r\n        this.state = {\r\n            disabled: false,\r\n            favorite: cookieMethods.contains(this.id)\r\n        };\r\n      }\r\n\r\n    onRaitingChangeHandler = (newValue) => () => {\r\n        const raitingValue = this.raitingElement.current.textContent;\r\n        this.raitingElement.current.textContent = +raitingValue + newValue;\r\n        this.setState({ disabled: true });\r\n    }\r\n\r\n    favoriteClickHandler = () => {\r\n        cookieMethods.toggle(this.id);\r\n        this.setState({ favorite: !this.state.favorite })\r\n    }\r\n\r\n    render() {\r\n        const { book } = this.props;\r\n        const { disabled, favorite } = this.state;\r\n        return <>\r\n            <div className=\"card mb-3\" style={{width: '300px'}}>\r\n                <div className=\"card-body\">\r\n                    <h5 className=\"card-title\">{book.title}</h5>\r\n                    <p className=\"my-0\"><i>Автор:</i> {book.author}</p>\r\n                    <p className=\"my-0\"><i>Год:</i> {book.date}</p>\r\n                    <p className=\"my-0\"><i>Издатель:</i> {book.publisher}</p>\r\n                    <p className=\"my-0\">\r\n                        <i>Рейтинг:</i>&nbsp;\r\n                        <button\r\n                            onClick={this.onRaitingChangeHandler(-1)}\r\n                            className=\"btn btn-link\"\r\n                            title=\"Уменьшить рейтинг\"\r\n                            disabled={disabled}\r\n                        >-</button>&nbsp;\r\n                        <span ref={this.raitingElement}>{book.raiting}</span>&nbsp;\r\n                        <button\r\n                            onClick={this.onRaitingChangeHandler(1)}\r\n                            className=\"btn btn-link\"\r\n                            title=\"Увеличить рейтинг\"\r\n                            disabled={disabled}\r\n                        >+</button> \r\n                    </p>\r\n                    <p className=\"my-0\">\r\n                        <button type=\"button\"onClick={this.favoriteClickHandler} className=\"btn btn-outline-primary btn-sm\">\r\n                            { favorite ? \"Удалить из избранного\" : \"Добавить в избранное\" }\r\n                        </button>\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </>;\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\nimport Spinner from '../Spinner/Spinner';\r\nimport ErrorElement from '../ErrorElement/ErrorElement';\r\nimport BookCard from '../BookCard/BookCard';\r\n\r\nexport default class ItemList extends React.Component {\r\n    componentDidMount() {\r\n        this.props.fetchItems();\r\n    }\r\n\r\n    render() {\r\n        const { loading, error } = this.props.state;\r\n        const { list, listName } = this.props;\r\n        let Content;\r\n\r\n        if (loading) {\r\n            Content = () => <Spinner/>;\r\n        } else if (error) {\r\n            Content = () => <ErrorElement error={error} />;\r\n        } else if (list.length === 0) {\r\n            Content = () => <div>Ничего не найдено!</div>;\r\n        } else {\r\n            Content = () => list.map(book => <BookCard key={`book${book.id}`} book={book} />)\r\n        }\r\n        return <>\r\n            <h5 className=\"w-100 mb-4 text-center\">{listName}</h5>\r\n            <Content/>\r\n        </>;\r\n    }\r\n};","import React from 'react';\r\nimport { withRouter as connectWithcRouter } from 'react-router-dom';\r\nimport { connect as connectWithStore } from 'react-redux';\r\n\r\nimport connectWithBookService from '../hoc/connectWithBookService';\r\nimport { fetchBooks } from '../../actions/actions';\r\nimport ItemList from '../ItemList/ItemList';\r\n\r\nconst BookList = (props) => <ItemList {...props} listName={\"Список книг\"}/>\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        state: state,\r\n        list: state.list,\r\n    }\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch, ownProps) => {\r\n    return {\r\n        fetchItems: fetchBooks(dispatch, ownProps),\r\n    }\r\n}\r\n\r\nexport default \r\n    connectWithcRouter(\r\n        connectWithBookService(\r\n            connectWithStore(mapStateToProps, mapDispatchToProps)(BookList)\r\n        )\r\n    );","import React from 'react';\r\nimport { withRouter as connectWithcRouter } from 'react-router-dom';\r\nimport { connect as connectWithStore } from 'react-redux';\r\n\r\nimport connectWithBookService from '../hoc/connectWithBookService';\r\nimport { fetchFavorites } from '../../actions/actions';\r\nimport ItemList from '../ItemList/ItemList';\r\n\r\nconst BookList = (props) => <ItemList {...props} listName={\"Список избранных книг\"}/>\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        state: state,\r\n        list: state.favorites,\r\n    }\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch, ownProps) => {\r\n    return {\r\n        fetchItems: fetchFavorites(dispatch, ownProps),\r\n    }\r\n}\r\n\r\nexport default \r\n    connectWithcRouter(\r\n        connectWithBookService(\r\n            connectWithStore(mapStateToProps, mapDispatchToProps)(BookList)\r\n        )\r\n    );","import React from 'react';\r\nimport { withRouter as connectWithcRouter } from 'react-router-dom';\r\n\r\nconst PageNotFound = ({ history }) => {\r\n    return (<div className=\"text-center mt-5\">\r\n        <h2>Ошибка 404: нет такой страницы!</h2>\r\n        <div>Вы можете вернуться на<button className=\"btn btn-link\" onClick={() => history.goBack()}>предыдущую страницу</button></div>\r\n    </div>);\r\n};\r\n\r\nexport default connectWithcRouter(PageNotFound);","import React from 'react';\r\nimport { Link } from 'react-router-dom';\r\n\r\nconst FavoritesButton = () => <div className=\"text-right mb-3\">\r\n    <Link to=\"/favorites\" type=\"button\" className=\"btn btn-light\">К списку избранных книг</Link>\r\n</div>;\r\n\r\nexport default FavoritesButton;","import React from 'react';\r\nimport { Link } from 'react-router-dom';\r\n\r\nconst MainPageButton = () => <div className=\"text-right mb-3\">\r\n    <Link to=\"/\" type=\"button\" className=\"btn btn-light\">На главную страницу</Link>\r\n</div>;\r\n\r\nexport default MainPageButton;","import React from 'react';\r\nimport { Switch, Route } from 'react-router-dom';\r\nimport Header from '../Header/Header';\r\nimport FilterSorterBlock from '../FilterSorterBlock/FilterSorterBlock';\r\nimport BookList from '../BookList/BookList';\r\nimport FavoritesList from '../FavoritesList/FavoritesList';\r\nimport ErrorBoundary from '../ErrorBoundary/ErrorBoundary';\r\nimport PageNotFound from '../PageNotFound/PageNotFound';\r\nimport FavoritesButton from '../FavoritesButton/FavoritesButton';\r\nimport MainPageButton from '../MainPageButton/MainPageButton';\r\n\r\nconst App = () => {\r\n    return (\r\n            <div className=\"container mt-5\">\r\n                <ErrorBoundary>\r\n                    <Switch>\r\n                        <Route path='/' exact component={FavoritesButton} />\r\n                        <Route path='/favorites' exact component={MainPageButton} />\r\n                    </Switch>\r\n                    <Header/>\r\n                    <Switch>\r\n                        <Route path='/' exact component={FilterSorterBlock} />\r\n                    </Switch>\r\n                </ErrorBoundary>\r\n            <div className=\"d-flex flex-row flex-wrap justify-content-around\">\r\n                <ErrorBoundary>\r\n                    <Switch>\r\n                        <Route path='/' exact component={BookList} />\r\n                        <Route path='/favorites' exact component={FavoritesList} />\r\n                        <Route component={PageNotFound} />\r\n                    </Switch>\r\n                </ErrorBoundary>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default App;","import books from './books.json';\r\n\r\nfunction timeout(data) {\r\n    return new Promise((resolve, reject) => {\r\n  \r\n      if (Math.round(Math.random()*10) === 9) {\r\n        reject(new Error('Тестовая ошибка (один раз из 10)'));\r\n      }\r\n  \r\n      setTimeout(() => {\r\n        resolve(data);\r\n      }, 1000);\r\n    });\r\n  }\r\n\r\nexport default class EmulatedBackend {\r\n    emulatedFetch(adress, data) {\r\n        switch (adress) {\r\n            case '/all':\r\n                return this.returnAllBooks();\r\n            case '/filtered':\r\n                return this.returnFilteredBooks(data.body);\r\n            default:\r\n                return new Error('404');\r\n        }\r\n    }\r\n\r\n    returnAllBooks() {\r\n        return timeout(books);\r\n    }\r\n\r\n    returnFilteredBooks(filters) {\r\n        let allFilteredBooks = books.list;\r\n        const filtersKeys = Object.keys(filters);\r\n        const notEmptyFiltersKeys = filtersKeys.filter(filterName => filters[filterName].value.length > 0);\r\n\r\n        notEmptyFiltersKeys.forEach(filterName => {\r\n            const { value: filterRawValue, type: filterType } = filters[filterName];\r\n            const filterValue = filterRawValue.trim().toLowerCase();\r\n            let currentlyFilteredBooks;\r\n            switch (filterType) {\r\n            case \"more\":\r\n                currentlyFilteredBooks = allFilteredBooks.filter(book => book[filterName] > filterValue);\r\n                allFilteredBooks = [ ...currentlyFilteredBooks ];\r\n                break;\r\n            case \"less\":\r\n                currentlyFilteredBooks = allFilteredBooks.filter(book => book[filterName] < filterValue);\r\n                allFilteredBooks = [ ...currentlyFilteredBooks ];\r\n                break;\r\n            case \"includes\":\r\n                currentlyFilteredBooks = allFilteredBooks.filter(book => book[filterName].toLowerCase().includes(filterValue));\r\n                allFilteredBooks = [ ...currentlyFilteredBooks ];\r\n                break;\r\n            case \"date-exact\":\r\n                currentlyFilteredBooks = allFilteredBooks.filter(book => book[filterName].format(\"YYYY\") === filterValue);\r\n                allFilteredBooks = [ ...currentlyFilteredBooks ];\r\n                break;\r\n            case \"array-exact\":\r\n                const filterValueArray = filters[filterName].options;\r\n                currentlyFilteredBooks = filterValueArray.map(key => {\r\n                    return allFilteredBooks.find(book => book.id === +key);\r\n                });\r\n                allFilteredBooks = [ ...currentlyFilteredBooks ];\r\n                break;\r\n            default:\r\n                currentlyFilteredBooks = allFilteredBooks.filter(book => book[filterName].toLowerCase() === filterValue);\r\n                allFilteredBooks = [ ...currentlyFilteredBooks ];\r\n            }\r\n        });\r\n\r\n        const respond = {\r\n            list: allFilteredBooks,\r\n        }\r\n        return timeout(respond);\r\n    }\r\n  }","import EmulatedBackend from './EmulatedBackend';\r\n\r\nconst emulatedBackend = new EmulatedBackend();\r\n\r\nexport default class BookService {\r\n    getAllBooks() {\r\n      return emulatedBackend.emulatedFetch('/all');\r\n    }\r\n    getFilteredBooks (filters) {\r\n      return emulatedBackend.emulatedFetch('/filtered', { body: filters });\r\n    }\r\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider as StoreProvider } from 'react-redux';\nimport { BrowserRouter } from 'react-router-dom';\nimport { ServiceProvider } from './component/ServiceContext/ServiceContext';\n\nimport ErrorBoundary from './component/ErrorBoundary/ErrorBoundary';\nimport store from './store';\nimport App from './component/App/App';\n\nimport BookService from './api/BookService';\nconst bookService = new BookService();\n\nReactDOM.render(\n  <StoreProvider store={store}>\n    <ErrorBoundary>\n      <ServiceProvider value={bookService}>\n        <BrowserRouter basename=\"/book-store\">\n          <App />\n        </BrowserRouter>\n      </ServiceProvider>\n    </ErrorBoundary>\n  </StoreProvider>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}